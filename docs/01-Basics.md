# Атомарные типы данных {#data_types}

## Числа {#numbers}

Числа — основной тип данных в R. К ним относятся _числа c плавающей точкой_ и _целые числа_. В терминологии R такие данные называются _интервальными_, поскольку к ним применимо понятие интервала на числовой прямой. Целые числа относятся к _дискретным интервальным_, а числа с плавающей точкой — к _непрерывным интервальным_. Числа можно складывать, вычитать и умножать:

```r
2 + 3
## [1] 5
2 - 3
## [1] -1
2 * 3
## [1] 6
```

Разделителем целой и дробной части является точка, а не запятая:

```r
2.5 + 3.1
## [1] 5.6
```

Существует также специальный оператор для возведения в степень. Для этого вы можете
использовать или двойной знак умножения (`**`) или _циркумфлекс_ (`^`), который в обиходе называют просто "крышечкой":

```r
2 ^ 3
## [1] 8
2 ** 3
## [1] 8
```

Результат деления по умолчанию имеет тип с плавающей точкой:

```r
5 / 3
## [1] 1.666667
5 / 2.5
## [1] 2
```

Если вы хотите чтобы деление производилось целочисленным образом (без дробной части) необходимо использовать оператор `%/%`:

```r
5 %/% 3
## [1] 1
```
Остаток от деления можно получить с помощью оператора `%%`:

```r
5 %% 3
## [1] 2
```

Вышеприведенные арифметические операции являются бинарными, то есть требуют наличия двух чисел. Числа называются "операндами". Отделять операнды от оператора пробелом или нет --- дело вкуса. Я предпочитаю отделять, так как это повышает читаемость кода. Следующие два выражения эквивалентны. Однако сравните простоту их восприятия:

```r
5%/%3
## [1] 1
```

```r
5 %/% 3
## [1] 1
```

Как правило, в настоящих программах числа в явном виде встречаются лишь иногда. Вместо этого для их обозначения используют переменные. В вышеприведенных выражениях мы неоднократно использовали число 3. Теперь представьте, что вы хотите проверить, каковы будут результаты, если вместо 3 использовать 4. Вам придется заменить все тройки на четверки. Если их много, то это будет утомительная работа, и вы наверняка что-то пропустите. Конечно, можно использовать поиск с автозаменой, но что если тройки надо заменить не везде? Одно и то же число может выполнять разные функции в разных выражениях. Чтобы избежать подобных проблем, в программе вводят переменные и присваивают им значения. Оператор присваивания значения выглядит как `<-`

```r
a <- 5
b <- 3
```

Чтобы вывести значение переменной на экран, достаточно просто ввести его:

```r
a
## [1] 5
b
## [1] 3
```

Мы можем выполнить над переменными все те же операции что и над константами:

```r
a + b
## [1] 8
a - b
## [1] 2
a / b
## [1] 1.666667
a %/% b
## [1] 1
a %% b
## [1] 2
```

Легко меняем значение второй переменной с 3 на 4 и выполняем код заново.

```r
b <- 4
a + b
## [1] 9
a - b
## [1] 1
a / b
## [1] 1.25
a %/% b
## [1] 1
a %% b
## [1] 1
```

Нам пришлось изменить значение переменной только один раз в момент ее создания, все последующие операции остались неизменны, но их результаты обновились!

Новую переменную можно создать на основе значений существующих переменных:

```r
c <- b
d <- a+c
```

Посмотрим, что получилось:

```r
c
## [1] 4
d
## [1] 9
```

Вы можете комбинировать переменные и заданные явным образом константы:

```r
e <- d + 2.5
e
## [1] 11.5
```

Противоположное по знаку число получается добавлением унарного оператора `-` перед константой или переменной:

```r
f <- -2
f
## [1] -2
f <- -e
f
## [1] -11.5
```

Операция взятия остатка от деления бывает полезной, например, когда мы хотим выяснить, является число четным или нет. Для этого достаточно взять остаток от деления на 2. Если число является четным, остаток будет равен нулю. В данном случае c равно 4, `d` равно 9:

```r
c %% 2
## [1] 0
d %% 2
## [1] 1
```

### Числовые функции {#number_functions}

Прежде чем мы перейдем к рассмотрению прочих типов данных и структур данных нам необходимо познакомиться с функциями, поскольку они встречаются буквально на каждом шагу. Понятие функции идентично тому, к чему мы привыкли в математике. Например, функция может называться `Z`, и принимать 2 аргумента: `x` и `y`. В этом случае она записывается как `Z(x,y)`. Чтобы получить значение функции, необходимо подставить некоторые значения вместо `x` и `y` в скобках. Нас даже может не интересовать, как фактически устроена функция внутри, но важно понимать, что именно она должна вычислять. С созданием функций мы познакомимся позднее.

Важнейшие примеры функций — математические. Это функции взятия корня `sqrt(x)`, модуля `abs(x)`, округления `round(x, digits)`, натурального логарифма `abs(x)`, тригонометрические функции `sin(x)`, `cos(x)`, `tan(x)`, обратные к ним `asin(y)`, `acos(y)`, `atan(y)` и многие другие. Основные математические функции содержатся в пакете [`base`](https://stat.ethz.ch/R-manual/R-devel/library/base/html/00Index.html), который по умолчанию доступен в среде R и не требует подключения. 

В качестве аргумента функции можно использовать переменную, константу, а также выражения:

```r
sqrt(a)
## [1] 2.236068
sin(a)
## [1] -0.9589243
tan(1.5)
## [1] 14.10142
abs(a + b - 2.5)
## [1] 6.5
```

Вы также можете легко вкладывать функции одна в одну, если результат вычисления одной функции нужно подставить в другую:

```r
sin(sqrt(a))
## [1] 0.7867491
sqrt(sin(a) + 2)
## [1] 1.020331
```

Также как и с арифметическими выражениями, результат вычисления функции можно записать в переменную:

```r
b <- sin(sqrt(a))
b
## [1] 0.7867491
```

Если переменной b ранее было присвоено другое значение, оно перезапишется. Вы также можете записать в переменную результат операции, выполненной над ней же. Например, если вы не уверены, что `a` — неотрицательное число, а вам это необходимо в дальнейших расчетах, вы можете применить к нему операцию взятия модуля:

```r
b <- sin(a)
b
## [1] -0.9589243
b <- abs(b)
b
## [1] 0.9589243
```

## Строки {#strings}

Строки — также еще один важнейший тип данных. Строки состоят из символов. Чтобы создать строковую переменную, необходимо заключить текст строки в кавычки:

```r
s <- "В историю трудно войти, но легко вляпаться (М.Жванецкий)"
s
## [1] "В историю трудно войти, но легко вляпаться (М.Жванецкий)"
```

Длину строки в символах можно узнать с помощью функции `nchar()`

```r
nchar(s)
## [1] 56
```

Строки можно складывать так же как и числа. Эта операция называется _конкатенацией_. В результате конкатенации строки состыковываются друг с другом и получается одна строка.
В отличие от чисел, конкатенация производится не оператором `+`, а специальной функцией `paste()`. Состыковываемые строки нужно перечислить через запятую, их число может быть произвольно

```r
s1 <- "В историю трудно войти,"
s2 <- "но легко вляпаться"
s3 <- "(М.Жванецкий)"
```

Посмотрим содержимое подстрок:

```r
s1
## [1] "В историю трудно войти,"
s2
## [1] "но легко вляпаться"
s3
## [1] "(М.Жванецкий)"
```

А теперь объединим их в одну:

```r
s <- paste(s1, s2)
s
## [1] "В историю трудно войти, но легко вляпаться"
s <- paste(s1, s2, s3)
s
## [1] "В историю трудно войти, но легко вляпаться (М.Жванецкий)"
```

Настоящая сила конкатенации проявляется когда вам необходимо объединить в одной строке некоторое текстовое описание (заранее известное) и значения переменных, которые у вас вычисляются в программе (заранее неизвестные). Предположим, вы нашли в программе что максимальная численность населения в Детройте пришлась на 1950 год и составила 1850 тыс. человек. Найденный год записан у вас в переменную `year`, а население в переменную `pop`. Вы их значения пока что не знаете, они вычислены по табличным данным в программе.
Как вывести эту информацию на экран "человеческим"" образом? Для этого нужно использовать конкатенацию строк. 

Условно запишем значения переменных, как будто мы их знаем

```r
year <- 1950
pop <- 1850
```


```r
s1 <- "Максимальная численность населения в Детройте пришлась на"
s2 <- "год и составила"
s3 <- "тыс. чел"
s <- paste(s1, year, s2, pop, s3)
s
## [1] "Максимальная численность населения в Детройте пришлась на 1950 год и составила 1850 тыс. чел"
```

Обратите внимание на то что мы конкатенировали строки с числами. Конвертация типов осуществилась автоматически. Помимо этого, функция сама вставила пробелы между строками.

## Даты {#dates}

Даты являются необходимыми при работе с временными данными. В географическом анализе подобные задачи возникают сплошь и рядом. Точность указания времени может быть самой различной. От года до долей секунды. Чаще всего используются даты, указанные с точностью до дня. Для создания даты используется функция `as.Date()`. В данном случае точка — это лишь часть названия функции, а не какой-то особый оператор. В качестве аргумента функции необходимо задать дату, записанную в виде строки. Запишем дату рождения автора (можете заменить ее на свою):

```r
birth <- as.Date('1986/02/18')
birth
## [1] "1986-02-18"
```

Сегодняшнюю дату вы можете узнать с помощью специальной функции `Sys.Date()`:

```r
current <- Sys.Date()
current
## [1] "2017-09-29"
```

Даты также можно складывать и вычитать. В зависимости от дискретности данных, вы получите результат в часах, днях, годах и т.д. Например, узнать продолжительность жизни в днях можно так:

```r
livedays <- current - birth
livedays
## Time difference of 11546 days
```

Вы также можете прибавить к текущей дате некоторое значение. Например, необходимо узнать, какая дата будет через 40 дней:

```r
current + 40
## [1] "2017-11-08"
```

С другими примерами использования дат мы познакомимся в дальнейшем по мере работы с данными.

## Логические {#booleans}

Логические переменные возникают там, где нужно проверить условие. Переменная логического типа может принимать значение `TRUE` (истина) или `FALSE` (ложь). Для их обозначения также возможны более компактные константы `T` и `F` соответственно.

Следующие операторы приводят к возникновению логических переменных:

* _РАВНО_ (`==`) --- проверка равенства операндов
* _НЕ РАВНО_ (`!=`) --- проверка неравенства операндов
* _МЕНЬШЕ_ (`<`) --- первый аргумент меньше второго
* _МЕНЬШЕ ИЛИ РАВНО_ (`<=`) --- первый аргумент меньше или равен второму
* _БОЛЬШЕ_ (`>`) --- первый аргумент больше второго
* _БОЛЬШЕ ИЛИ РАВНО_ (`>=`) --- первый аргумент больше или равен второму

Посмотрим, как они работают:

```r
a <- 1
b <- 2
a == b
## [1] FALSE
a != b
## [1] TRUE
a > b
## [1] FALSE
a < b
## [1] TRUE
```

Если необходимо проверить несколько условий одновременно, их можно комбинировать с помощью логических операторов. Наиболее популярные среди них: 

* _И_ (`&&`) - проверка истинности обоих условий 
* _ИЛИ_ (`||`) - проверка истинности хотя бы одного из условий
* _НЕ_ (`!`) - отрицание операнда (истина меняется на ложь, ложь на истину)


```r
c<-3
(b>a) && (c>b)
## [1] TRUE
(a>b) && (c>b)
## [1] FALSE
(a>b) || (c>b)
## [1] TRUE
!(a>b)
## [1] TRUE
```

Более подробно работу с логическими переменными мы разберем далее при знакомстве с условным оператором `if`.

## Контрольные вопросы и задачи {#questions_basics}

### Вопросы

1. Какие типы данных поддерживаются в R? Каковы их англоязычные наименования?

1. С помощью какой функции можно узнать тип данных переменной?

1. Какой символ является разделителем целой и дробной части при записи чисел с плавающей точкой?

1. Что такое операторы и операнды? Приведите примеры бинарных и унарных операторов.

1. Какое значение будет имет результат деления на ноль?

1. Какие функции выполняют операторы `%%, %/%, ^, **`?

1. Как проверить, является ли число четным?

1. Как определить количество символов в строке?

1. Как называется операция состыковки нескольких строк и с помощью какой функции она выполняется? Как добиться того, чтобы при этом не добавлялись пробелы между строками?

1. С помощью какой функции можно создать дату из строки?

1. Какая функция позволяет получить дату сегодняшнего дня?

1. Можно ли складывать даты и числа? Если да, то в каких единицах измерения будет выражен результат?

1. Какова краткая форма записи логических значений `TRUE` и `FALSE`?

1. Каким числам соответствуют логические значения `TRUE` и `FALSE`?

1. Сколько операндов должно быть верно, чтобы оператор логического И (`&&`) принял значение `TRUE`? Что можно сказать в этом отношении об операторе ИЛИ (`||`)?

1. Можно ли применять арифметические операции к логическим переменным? Что произойдет, если прибавить или вычесть из числа `a` значение `TRUE`? А если заменить на `TRUE` на `FALSE`

### Задачи

1. Напишите выражение для вычисления длины отрезка по координатам его вершин, хранящимся в переменных `x1, y1, x2, y2`

1. Не используя оператор `!=` запишите условие неравенства чисел `a` и `b` с помощью других логичеcких операторов.

1. Напишите программу, которая считывает из консоли введенную пользователем строку и выводит в консоль количество символов в этой строке. Вывод оформите следующим образом: `"Длина введенной строки равняется ... символам"`, где вместо многоточия стоит вычисленная длина.

1. Напишите программу, которая определяет количество дней в феврале года, который хранится в переменной `y`. Протестируйте программу, меняя значение `y`.

----
_Самсонов Т.Е._ **Визуализация и анализ географических данных на языке R.** М.: Географический факультет МГУ, 2017. DOI: 10.5281/zenodo.901911
----
